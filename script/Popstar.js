!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=9)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(){r(this,e),this.paused=!0,this.queue=new Map,this.usingRAF=!1,Reflect.defineProperty(this,"useRAF",{set:function(t){Reflect.set(this,"usingRAF",t),t?e.RAF.enable():e.RAF.disable()}})}return n(e,[{key:"setTimeout",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Symbol("timeoutID");return this.queue.set(i,{fn:e,type:0,paused:0,elapsed:0,delay:t}),i}},{key:"clearTimeout",value:function(e){return this.delete(e)}},{key:"setInterval",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Symbol("intervalID");return this.queue.set(i,{fn:e,type:1,paused:0,elapsed:0,delay:t}),i}},{key:"clearInterval",value:function(e){return this.delete(e)}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.queue.get(e)||{};for(var n in t)i[n]=t[n];return!0}},{key:"delete",value:function(e){return this.queue.delete(e)}},{key:"pause",value:function(e){return void 0===e?this.pauseAll():this.queue.get(e).paused=1,!0}},{key:"resume",value:function(e){return this.play(e)}},{key:"play",value:function(e){return void 0===e?this.playAll():this.queue.get(e).paused=0,!0}},{key:"clean",value:function(){return this.queue=new Map,!0}},{key:"pauseAll",value:function(){return this.queue.forEach(function(e){return e.paused=1}),!0}},{key:"playAll",value:function(){return this.queue.forEach(function(e){return e.paused=0}),!0}},{key:"tick",value:function(e){this.paused||this.updateQueue(e)}},{key:"updateQueue",value:function(e){var t=this;this.queue.forEach(function(i,n){1!==i.paused&&(i.elapsed+=e,i.elapsed>=i.delay&&(i.fn(),0===i.type?t.delete(n):i.elapsed=0))})}},{key:"update",value:function(){var e=this;this.useRAF=!1,this.update=function(t){e.usingRAF||e.tick(t)}}}]),e}(),s=function(){function e(){r(this,e),this.time=0,this.auto=this.auto.bind(this)}return n(e,[{key:"auto",value:function(e){a.tick(e-this.time),this.time=e,this.id=requestAnimationFrame(this.auto)}},{key:"enable",value:function(){a.paused=!1,this.id=requestAnimationFrame(this.auto)}},{key:"disable",value:function(){cancelAnimationFrame(this.id)}}]),e}();o.RAF=new s;var a=new o;a.useRAF=!0,t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defineEvent={}}return n(e,[{key:"register",value:function(e,t){this.defineEvent[e]?this.defineEvent[e].push(t):this.defineEvent[e]=[t]}},{key:"dispatch",value:function(e,t){if(this.defineEvent[e])for(var i=0,n=this.defineEvent[e].length;i<n;++i)this.defineEvent[e][i]&&this.defineEvent[e][i](t)}},{key:"on",value:function(e,t){return this.register(e,t)}},{key:"off",value:function(e,t){var i=this;if(this.defineEvent[e])if(void 0===t)delete this.defineEvent[e];else for(var n=function(n,r){if(t==i.defineEvent[e][n])return i.defineEvent[e][n]=null,setTimeout(function(){return i.defineEvent[e].splice(n,1)},0),"break"},r=0,o=this.defineEvent[e].length;r<o;++r){if("break"===n(r))break}}},{key:"once",value:function(e,t){var i=this;this.register(e,function n(){t&&t(),i.off(e,n)})}}]),e}();t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=s(i(1)),o=s(i(0));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t,i){var n=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.view=i,this.event=new r.default,this.view.event=this.event,Reflect.defineProperty(this,"total",{get:function(){return n.view.total},set:function(e){return n.view.total=e}}),this.view.timer=o.default,Object.defineProperties(this,{curLevel:{get:function(){return n._curLevel||0},set:function(e){n._curLevel=e||0,n.view.setLevel(n._curLevel+1)}},goal:{get:function(){return n._goal||0},set:function(e){n._goal=e||0,n.view.setGoal(e)}}}),t.tiles.forEach(function(e){Reflect.defineProperty(e,"index",{set:function(t){if(t===e._index)return!1;Reflect.set(e,"_index",t),i.update(e)},get:function(){return Reflect.get(e,"_index")}}),Reflect.defineProperty(e,"clr",{set:function(t){if(t===e._clr)return!1;Reflect.set(e,"_clr",t),i.update(e)},get:function(){return Reflect.get(e,"_clr")}}),Reflect.defineProperty(e,"removed",{set:function(t){if(t===e._removed)return!1;Reflect.set(e,"_removed",t),i.update(e)},get:function(){return Reflect.get(e,"_removed")||!1}})}),this.total=s,this.event.on("view-tap",function(e){if(!0!==n.paused){var t=n.model.clean(e);t>0&&n.view.setCleanInfo(t)}}),this.event.on("view-clean",function(){n.model.tamp(),!1===n.model.check()&&n.view.showBountyInfo(n.model.tileCount).then(function(){return n.model.cleanAll()})}),this.event.on("view-clean-all",function(){n.total<n.goal?n.event.dispatch("gameover"):n.event.dispatch("pass")}),this.event.on("view-press-pause",function(){n.event.dispatch("pause")}),this.event.on("view-press-play",function(){n.event.dispatch("resume")}),this.init=this.init.bind(this),this.destroy=this.destroy.bind(this),this.enter=this.enter.bind(this),this.next=this.next.bind(this),this.pause=this.pause.bind(this),this.resume=this.resume.bind(this)}return n(e,[{key:"init",value:function(){this.model.init(),this.view.init()}},{key:"destroy",value:function(){this.view.destroy(),this.total=0}},{key:"enter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.curLevel=e||0,this.goal=2e3*e+1e3,this.init()}},{key:"next",value:function(){this.enter(this.curLevel+1)}},{key:"pause",value:function(){o.default.pause(),this.view.pause(),this.paused=!0}},{key:"resume",value:function(){o.default.resume(),this.view.resume(),this.paused=!1}}]),e}();t.default=a},function(e,t){var i=PIXI.DisplayObject.prototype;i.set=function(e){for(let t in e)this[t]=e[t]},Object.defineProperties(i,{scaleX:{set:function(e){this.scale.x=e},get:function(){return this.scale.x}},scaleY:{set:function(e){this.scale.y=e},get:function(){return this.scale.y}},pivotX:{set:function(e){this.pivot.x=e},get:function(){return this.pivot.x}},pivotY:{set:function(e){this.pivot.y=e},get:function(){return this.pivot.y}},anchorX:{set:function(e){this.anchor.x=e},get:function(){return this.anchor.x}},anchorY:{set:function(e){this.anchor.y=e},get:function(){return this.anchor.y}},origin:{get:function(){return[this.pivot.x,this.pivot.y]},set:function(e){this.pivot.set(e[0],e[1]),this.updatePosition()}},left:{get:function(){return void 0===this._left?this.x-this.pivot.x:this._left},set:function(e){this._left=e,this.x=e+this.pivot.x}},right:{get:function(){return void 0===this._right?this._right:this.x-this.pivot.x},set:function(e){void 0!==e&&(this._right=e,null!==this.parent?this.x=this.parent.width-this.width-e:this.x=0)}},top:{get:function(){return void 0===this._top?this.y-this.pivot.y:this._top},set:function(e){this._top=e,this.y=e+this.pivot.y}},bottom:{get:function(){return void 0===this._bottom?this._bottom:this.y-this.pivot.y},set:function(e){void 0!==e&&(this._bottom=e,null!==this.parent?this.y=this.parent.height-this.height-e:this.y=0)}},time:{set:function(e){let t=e-this._t||e;this._t=e;let{velocityX:i,velocityY:n,accelerationX:r,accelerationY:o}=this;this.velocityX+=t*r,this.velocityY+=t*o,this.x+=(this.velocityX+i)*t/2,this.y+=(this.velocityY+n)*t/2},get:function(){return this._t}}}),Object.assign(i,{velocityX:0,velocityY:0,accelerationX:0,accelerationY:0,_top:0,_left:0}),i.updatePosition=function(){this.top=this._top,this.right=this._right,this.bottom=this._bottom,this.left=this._left};var n=PIXI.Container.prototype.addChild;PIXI.Container.prototype.addChild=function(){var e=arguments.length;if(0!==e){n.apply(this,arguments);for(var t=0;t<e;++t){var i=arguments[t];i.right=i._right,i.bottom=i._bottom}}};var r=PIXI.Container.prototype.addChildAt;PIXI.Container.prototype.addChildAt=function(e,t){r.call(this,e,t),e.right=e._right,e.bottom=e._bottom}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();i(3);var r=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=375/603,r=1,o=function(){var e=document.documentElement.clientWidth,t=document.documentElement.clientHeight;if(e>t){var o=[t,e];e=o[0],t=o[1]}var a=t/e;a!==n&&(n=a,r=t/603,i.height=i.width*n,i.app&&s.renderer.resize(i.width,i.height))};this.width=375,this.height=603,o(),window.addEventListener("resize",o);var s=new PIXI.Application({width:this.width,height:this.height,resolution:2,backgroundColor:3355443,view:t});Object.assign(this,s),this.ticker=s.ticker,this.originClrs=[14965851,6610794,4035041,16768891,15482876],this.tiles=new Array(100),this.area=new PIXI.Container;var a=PIXI.Sprite.from(PIXI.Texture.EMPTY);a.set({width:this.width,height:this.width}),this.area.addChild(a),this.area.set({x:.5,y:this.height-this.width}),this.tileSize=36.5,this.gridWidth=37.5,this.gridHeight=37.5,this.col=this.row=10,this.centerX=this.width/2,this.game=new PIXI.Container,this.stage.addChild(this.game),this.game.addChild(this.area),this.hideGame(),this.area.on("ontouchstart"in document?"tap":"click",function(e){if(!0!==i.paused){var t=e.data.global.x,n=e.data.global.y-i.area.y,r=(t/i.gridWidth>>0)+10*(n/i.gridHeight>>0);i.event.dispatch("view-tap",r)}}),this.level=new PIXI.Text("关卡：0",{fontFamily:"Arial",fontSize:16,fill:16777215}),this.level.set({top:16,left:16}),this.goal=new PIXI.Text("目标：0",{fontFamily:"Arial",fontSize:16,fill:16777215,align:"center"}),this.goal.set({anchorX:.5,anchorY:.5,x:this.centerX,top:25}),this.totalLabel=new PIXI.Text("0",{fontFamily:"Arial",fontSize:24,fill:16249864,align:"center"}),this.totalLabel.set({anchorX:.5,anchorY:.5,x:this.centerX,top:50}),Reflect.defineProperty(this,"total",{get:function(){return i._total||0},set:function(e){i._total=e,i.totalLabel.text=e}}),this.cleanInfo=new PIXI.Text("",{fontFamily:"Arial",fontSize:16,fill:16777215,align:"center"}),this.cleanInfo.set({anchorX:.5,anchorY:.5,x:this.centerX,top:78}),this.bountyLabel=new PIXI.Text("奖励 ",{fontFamily:"Arial",fontSize:16,fill:16777215,align:"center"}),this.bountyLabel.set({anchorX:.5,anchorY:.5,x:this.centerX,top:410*r,defaultTop:410*r,renderable:!1}),this._bounty=2e3,Reflect.defineProperty(this,"bounty",{get:function(){return i._bounty},set:function(e){i._bounty=e,i.bountyLabel.text="奖励 "+e}}),this.starInfo=new PIXI.Text("",{fontFamily:"Arial",fontSize:12,fill:16777215,align:"center"}),this.starInfo.set({anchorX:.5,anchorY:.5,x:this.centerX,top:435*r,renderable:!1}),this.levelInfo=new PIXI.Container,this.levelInfo.title=new PIXI.Text("关卡 n",{fontFamily:"Arial",fontSize:30,fill:16777215,align:"center"}),this.levelInfo.title.set({anchorX:.5,anchorY:.5,x:this.centerX,top:260*r}),this.levelInfo.goal=new PIXI.Text("目标分数 xxxx",{fontFamily:"Arial",fontSize:14,fill:16777215,align:"center"}),this.levelInfo.goal.set({anchorX:.5,anchorY:.5,x:this.centerX,top:300*r}),this.levelInfo.addChild(this.levelInfo.title,this.levelInfo.goal),this.game.addChild(this.level,this.goal,this.totalLabel,this.cleanInfo,this.bountyLabel,this.starInfo),this.generateTileTextures(),this.generateStarTextures(),this.bombList=[],PIXI.loader.add([{name:"red",url:"images/red@2x.png"},{name:"green",url:"images/green@2x.png"},{name:"blue",url:"images/blue@2x.png"},{name:"yellow",url:"images/yellow@2x.png"},{name:"purple",url:"images/purple@2x.png"},{name:"star_red",url:"images/star_red@2x.png"},{name:"star_green",url:"images/star_green@2x.png"},{name:"star_blue",url:"images/star_blue@2x.png"},{name:"star_yellow",url:"images/star_yellow@2x.png"},{name:"star_purple",url:"images/star_purple@2x.png"},{name:"pause",url:"images/pause@2x.png"},{name:"play",url:"images/play@2x.png"},{name:"cover",url:"images/cover.jpg"},{name:"rewards",url:"images/rewards.jpg"}]).load(function(){["red","green","blue","yellow","purple"].forEach(function(e,t){i.tileTextures[t].baseTexture=PIXI.utils.TextureCache[e].baseTexture,i.starTextures[t].baseTexture=PIXI.utils.TextureCache["star_"+e].baseTexture});var e=new PIXI.Sprite(PIXI.utils.TextureCache.pause);e.interactive=!0,e.on("ontouchstart"in document?"tap":"click",function(){var t=e.texture.textureCacheIds[0];i.event.dispatch("view-press-"+t)}),e.set({top:12,left:325}),i.game.addChild(e),i.btn=e,i.stage.addChildAt(new PIXI.Sprite(PIXI.utils.TextureCache.cover),0)})}return n(e,[{key:"init",value:function(){var e=this;!1===this.ticker.started&&this.ticker.start(),this.area.renderable=this.bountyLabel.renderable=this.starInfo.renderable=!1,this.showGame(),this.showLevelInfo().then(function(){e.area.interactive=!0,e.area.renderable=!0;for(var t=e.tiles.length,i=t-1;i>=0;--i){var n=e.tiles[i];TweenMax.from(n.sprite,.5,{y:"-="+(600-Math.random()*e.gridHeight>>0),delay:.05*((t-i)/e.col>>0),ease:Linear.easeNone})}}),this.destroy=this.destroy.bind(this),this.showLevelInfo=this.showLevelInfo.bind(this),this.generateTileSprite=this.generateTileSprite.bind(this),this.generateStar=this.generateStar.bind(this),this.updateTileClr=this.updateTileClr.bind(this),this.updateTileIndex=this.updateTileIndex.bind(this),this.generateTileTextures=this.generateTileTextures.bind(this),this.generateStarTextures=this.generateStarTextures.bind(this),this.update=this.update.bind(this),this.bomb=this.bomb.bind(this),this.showTileScore=this.showTileScore.bind(this),this.setCleanInfo=this.setCleanInfo.bind(this),this.setLevel=this.setLevel.bind(this),this.setGoal=this.setGoal.bind(this),this.showBountyInfo=this.showBountyInfo.bind(this),this.hideGame=this.hideGame.bind(this),this.showGame=this.showGame.bind(this),this.pause=this.pause.bind(this),this.resume=this.resume.bind(this)}},{key:"destroy",value:function(){this.ticker.stop(),this.timer.clean(),this.paused=!1,this.game.renderable=!1,this.renderer.render(this.stage)}},{key:"showLevelInfo",value:function(){var e=this;return this.game.addChild(this.levelInfo),new Promise(function(t,i){TweenMax.fromTo(e.levelInfo,.6,{x:e.width},{x:0}),TweenMax.to(e.levelInfo,.6,{x:-e.width,delay:3,onComplete:function(){e.levelInfo.parent.removeChild(e.levelInfo),t()}}),TweenMax.fromTo(e.levelInfo.goal,.6,{x:e.centerX+e.width},{x:e.centerX,delay:.6}),TweenMax.to(e.goal,.15,{alpha:0,delay:1.2,repeat:9,yoyo:!0,ease:Linear.easeNone})})}},{key:"generateTileSprite",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new PIXI.Sprite(this.tileTextures[e])}},{key:"generateStar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return new PIXI.Sprite(this.starTextures[e%5])}},{key:"updateTileClr",value:function(e,t){void 0!==t&&(e.sprite.texture=this.tileTextures[t],e.clr=t)}},{key:"updateTileIndex",value:function(e,t){var i=t%this.col*this.gridWidth,n=(t/this.col>>0)*this.gridHeight;e.index=t,TweenMax.to(e.sprite,.08,{x:i,y:n,ease:Linear.easeNone})}},{key:"generateTileTextures",value:function(){var e=this;this.tileTextures=this.originClrs.map(function(t){return(new PIXI.Graphics).beginFill(t).drawRoundedRect(0,0,e.tileSize,e.tileSize,6).generateCanvasTexture()})}},{key:"generateStarTextures",value:function(){this.starTextures=this.originClrs.map(function(e){return(new PIXI.Graphics).beginFill(e).drawPolygon([20,0,26.5,16,40,15,28,25,32,38,20,30,8,38,12,23,12,24,0,15,15,15]).generateCanvasTexture()})}},{key:"update",value:function(e){var t=e.originIndex,i=e.index,n=e.clr,r=e.removed,o=e.score;if(void 0!==t&&void 0!==n){var s=this.tiles[t];void 0===s?(this.tiles[t]=s={sprite:this.generateTileSprite(n),clr:n,index:i,score:0,originIndex:t,removed:!0},this.updateTileIndex(s),this.area.addChild(s.sprite)):s.clr!==n&&this.updateTileClr(s,n),s.index!==i&&this.updateTileIndex(s,i),s.score!==o&&(s.score=o),s.removed!==r&&(!0===r?this.bomb(s):this.area.addChild(s.sprite),s.removed=r)}}},{key:"bomb",value:function(e){var t=this;if(!0!==this.bombLock){this.bombLock=!0;e.index;for(var i=e.clr,n=e.sprite,r=e.sprite,o=r.x,s=r.y,a=1,l=function(e,n){var r=t.generateStar(i);t.area.addChild(r),a*=-1,r.set({origin:[r.width/2,r.height/2],top:s,left:o,scaleX:.5,scaleY:.5,alpha:.9,velocityX:(10*Math.random()+1)*a,velocityY:10*Math.random()-20,accelerationY:Math.random()+2}),TweenMax.to(r,1.5,{scaleX:.15,scaleY:.15,alpha:.1,time:.6,ease:Linear.easeNone,onComplete:function(){return r.destroy()}})},h=0;h<=12;++h)l();var u=function(){var i=t.bombList.shift();if(t.bombLock=!1,n.parent.removeChild(n),void 0!==i)t.bomb(i);else if(e.score>0)t.event.dispatch("view-clean");else if(t.bounty>0){var r=t.bounty/10;TweenMax.to(t.bountyLabel,.6,{top:80,onComplete:function(){t.timer.setInterval(function(){t.total+=r,t.bounty-=r,0===t.bounty&&(t.timer.delete("bounty"),t.timer.setTimeout(function(){return t.event.dispatch("view-clean-all")},1400))},80,"bounty")}})}else t.timer.setTimeout(function(){return t.event.dispatch("view-clean-all")},1400)};if(e.score>0)this.showTileScore(e);else{if(!(this.bounty>0))return u();this.bounty+=e.score}this.timer.setTimeout(u,120)}else this.bombList.push(e)}},{key:"showTileScore",value:function(e){var t=this,i=new PIXI.Text(e.score,{fontFamily:"Arial",fontSize:32,fill:16777215,align:"center"});i.set({anchorX:.5,anchorY:.5,x:e.sprite.x,y:e.sprite.y}),TweenMax.to(i,.4,{x:this.centerX,y:603-this.height-158,scaleX:.5,scaleY:.5,ease:Linear.easeNone,onComplete:function(){i.parent.removeChild(i),t.total+=e.score}}),this.area.addChild(i)}},{key:"setCleanInfo",value:function(e){this.cleanInfo.tween&&this.cleanInfo.tween.kill(),this.cleanInfo.text=e+"连消 "+e*e*5+"分",this.cleanInfo.tween=TweenMax.fromTo(this.cleanInfo,.3,{alpha:0},{alpha:1,repeat:1,yoyo:!0,repeatDelay:1})}},{key:"setLevel",value:function(e){this.level.text="关卡："+e,this.levelInfo.title.text="关卡"+e}},{key:"setGoal",value:function(e){this.goal.text="目标："+e,this.levelInfo.goal.text="目标分数 "+e}},{key:"showBountyInfo",value:function(e){var t=this;return this.bountyLabel.renderable=this.starInfo.renderable=!0,this.starInfo.text="剩余 "+e+" 个星星",this.bounty=2e3,this.bountyLabel.top=this.bountyLabel.defaultTop,new Promise(function(e,i){TweenMax.fromTo(t.area,.1,{alpha:1},{alpha:0,yoyo:!0,repeat:7,ease:Linear.easeNone,onComplete:function(){return e()}})})}},{key:"hideGame",value:function(){this.game.renderable=!1}},{key:"showGame",value:function(){this.game.renderable=!0}},{key:"pause",value:function(){TweenMax.pauseAll(),this.paused=!0,this.btn.texture=PIXI.utils.TextureCache.play}},{key:"resume",value:function(){TweenMax.resumeAll(),this.paused=!1,this.btn.texture=PIXI.utils.TextureCache.pause}},{key:"showReardsBackground",value:function(){this.stage.removeChildAt(0),this.stage.addChildAt(new PIXI.Sprite(PIXI.utils.TextureCache.rewards),0)}}]),e}();t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=[];if(t>(e-1)*i||i>(e-1)*t)return new Array(e).fill(0);var o=0,s=t,a=-i,l=0,h=e;for(;--h>=0;){t>h*i-l&&(s=h*i-l),i>h*t+l&&(a=-l-h*t),o=s-a;var u=void 0;u=h>0?a+Math.random()*(o+1):-l,!0===n&&(u=Math.floor(u)),l+=u,r.push(u)}return r}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=e.length;t;t--){var i=Math.floor(Math.random()*t),n=[e[i],e[t-1]];e[t-1]=n[0],e[i]=n[1]}return e}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=a(i(6)),s=a(i(5));function a(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.row=this.col=10,this.wall=new Array(this.col);for(var t=0;t<this.col;++t)this.wall[t]={count:this.row,start:0,end:this.row-1,pitCount:0,topPit:this.row,bottomPit:-1};this.updatedColSet=new Set,this.gridCellCount=100,this.grid=[],this.tiles=new Array(this.gridCellCount);for(var i=0;i<this.gridCellCount;++i)this.tiles[i]={originIndex:void 0,index:void 0,clr:0,score:0,removed:!1};this.tileCount=this.gridCellCount,this.init=this.init.bind(this),this.compareTopTile=this.compareTopTile.bind(this),this.incompareRightTileit=this.compareRightTile.bind(this),this.compareBottomTile=this.compareBottomTile.bind(this),this.compareLeftTile=this.compareLeftTile.bind(this),this.hasNeighbour=this.hasNeighbour.bind(this),this.searchSameClr=this.searchSameClr.bind(this),this.deleteCell=this.deleteCell.bind(this),this.clean=this.clean.bind(this),this.cleanAll=this.cleanAll.bind(this),this.updateColInfo=this.updateColInfo.bind(this),this.tamp=this.tamp.bind(this),this.check=this.check.bind(this)}return r(e,[{key:"init",value:function(){var e=this,t=0;(0,s.default)(5,4,4).forEach(function(i,n){for(i+=20;0<i--;){var r=e.tiles[t++];delete r.originIndex,r.clr=n}}),(0,o.default)(this.tiles),this.grid=this.tiles.map(function(e,t){return e.index=t,e.originIndex=t,e.removed=!1,e}),this.tileCount=this.gridCellCount;for(var i=0;i<this.col;++i)this.wall[i]={count:this.row,start:0,end:this.row-1,pitCount:0,topPit:this.row,bottomPit:-1};!1===this.check()&&this.init()}},{key:"compareTopTile",value:function(e,t,i,n){var r=e-this.col;return t!==this.wall[i].start&&(void 0!==this.grid[r]&&this.grid[r].clr===n&&r)}},{key:"compareRightTile",value:function(e,t,i,n){var r=e+1;return i!==this.wall.length-1&&(void 0!==this.grid[r]&&this.grid[r].clr===n&&r)}},{key:"compareBottomTile",value:function(e,t,i,n){var r=e+this.col;return t!==this.wall[i].end&&(void 0!==this.grid[r]&&this.grid[r].clr===n&&r)}},{key:"compareLeftTile",value:function(e,t,i,n){var r=e-1;return 0!==i&&(void 0!==this.grid[r]&&this.grid[r].clr===n&&r)}},{key:"hasNeighbour",value:function(e,t,i){var n=this.grid[e];if(void 0===n)return!1;var r=n.clr;return!1!==this.compareTopTile(e,t,i,r)||(!1!==this.compareRightTile(e,t,i,r)||(!1!==this.compareBottomTile(e,t,i,r)||!1!==this.compareLeftTile(e,t,i,r)))}},{key:"searchSameClr",value:function(e,t,i,n){return[this.compareTopTile(e,t,i,n),this.compareRightTile(e,t,i,n),this.compareBottomTile(e,t,i,n),this.compareLeftTile(e,t,i,n)].filter(function(e){return!1!==e})}},{key:"deleteCell",value:function(e,t,i,n){var r=this.grid[e];return void 0!==r&&(r.score=10*n+5,r.removed=!0,delete this.grid[e],this.updateColInfo(e,t,i),!0)}},{key:"clean",value:function(e){var t=this,i=e%this.col,r=e/this.col>>0;if(!1===this.hasNeighbour(e,r,i))return 0;var o=function(){var n=t.grid[e].clr,o=t.searchSameClr(e,r,i,n),s=0;t.deleteCell(e,r,i,s)&&++s;for(var a=function(){var e=[];if(o.forEach(function(i){var r=i%t.col,o=i/t.col>>0;e.push.apply(e,function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(t.searchSameClr(i,o,r,n))),t.deleteCell(i,o,r,s)&&++s}),0===e.length)return"break";o=e};;){if("break"===a())break}return{v:s}}();return"object"===(void 0===o?"undefined":n(o))?o.v:void 0}},{key:"cleanAll",value:function(){for(var e=0,t=0,i=this.wall.length;t<i;++t)for(var n=this.wall[t],r=n.start;r<=n.end;++r){var o=this.grid[r*this.col+t];o.score=-20-40*e++,o.removed=!0}}},{key:"updateColInfo",value:function(e,t,i){this.updatedColSet.has(i)||this.updatedColSet.add(i);var n=this.wall[i];--n.count,++n.pitCount,n.topPit=Math.min(n.topPit,t),n.bottomPit=Math.max(n.bottomPit,t),--this.tileCount}},{key:"tamp",value:function(){var e=[],t=this.col,i=-1,n=!0,r=!1,o=void 0;try{for(var s,a=this.updatedColSet[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value,h=this.wall[l],u=h.start,c=h.end,f=h.pitCount,d=h.topPit,v=h.bottomPit;h.count;if(f>0)if(v-d+1===f){if(d>u)for(var p=(d-1)*this.col+l,y=u*this.col+l,g=v*this.col+l,m=p;m>=y;m-=this.col,g-=this.col){var b=this.grid[g]=this.grid[m];delete this.grid[m],b.index=g}}else for(var w=v*this.col+l,x=w-this.col,I=u*this.col+l,T=x;T>=I;T-=this.col){var k=this.grid[T];void 0!==k&&(this.grid[w]=k,delete this.grid[T],k.index=w,w-=this.col)}h.start+=f,0===h.count?(e.push(l),i=Math.max(l,i),t=Math.min(l,t)):(h.pitCount=0,h.topPit=h.count,h.bottomPit=-1)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}var C=e.length,P=this.wall.length;if(C>0){if(1===C||i-t+1===C){if(i!==P-1)for(var _=i+1;_<P;++_){for(var X=this.wall[_],S=(u=X.start,c=X.end,u);S<=c;++S){var L=S*this.col+_,A=L-C,M=this.grid[A]=this.grid[L];delete this.grid[L],M.index=A}this.wall[_-C]=X,delete this.wall[_]}}else for(var R=t,E=t+1;E<P;++E){var j=this.wall[E],F=(u=j.start,c=j.end,E-R);if(j.count>0){for(var Y=u;Y<=c;++Y){var O=Y*this.col+E,z=O-F,G=this.grid[z]=this.grid[O];delete this.grid[O],G.index=z}this.wall[R]=j,delete this.wall[E],++R}}this.wall.splice(P-C,C)}this.updatedColSet.clear()}},{key:"check",value:function(){if(0===this.tileCount)return!1;for(var e=Math.random()*this.wall.length>>0,t=this.wall[e],i=t.start,n=t.end,r=Math.random()*(n-i+1)+i>>0,o=e;o>=0;--o)for(var s=this.wall[o],a=e===o?r:s.start;a<=s.end;++a){var l=a*this.col+o;if(this.hasNeighbour(l,a,o))return l}for(var h=e,u=this.wall.length;h<u;++h)for(var c=this.wall[h],f=e===h?r-1:c.end;f>=c.start;--f){var d=f*this.col+h;if(this.hasNeighbour(d,f,h))return d}return!1}}]),e}();t.default=l},function(e,t,i){"use strict";var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=a(i(7)),o=a(i(4)),s=a(i(2));function a(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=new r.default,this.view=new o.default(t.view),this.constrol=new s.default(this.model,this.view,t.total),this.event=this.constrol.event,Reflect.defineProperty(this,"total",{get:function(){return i.constrol.total},set:function(e){return i.constrol.total=e}}),Reflect.defineProperty(this,"level",{get:function(){return i.constrol.curLevel}})}return n(e,[{key:"enter",value:function(e){this.constrol.enter(e)}},{key:"next",value:function(){this.constrol.next()}},{key:"pause",value:function(){this.constrol.pause()}},{key:"resume",value:function(){this.constrol.resume()}},{key:"destroy",value:function(){this.constrol.destroy()}}]),e}();window.Popstar=l},function(e,t,i){e.exports=i(8)}]);